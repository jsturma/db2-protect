+ export DB2INSTANCE=db2inst1
+ DB2INSTANCE=db2inst1
+ db2_cmd 'db2 connect to SAMPLE'
+ log INFO 'Connected: SAMPLE'
+ local l=INFO
+ shift
++ date '+%Y-%m-%d %H:%M:%S'
+ local 'msg=[2025-11-21 14:42:53] [INFO] Connected: SAMPLE'
+ echo '[2025-11-21 14:42:53] [INFO] Connected: SAMPLE'
[2025-11-21 14:42:53] [INFO] Connected: SAMPLE
+ echo '[2025-11-21 14:42:53] [INFO] Connected: SAMPLE'
+ verify_db_rights
+ log INFO 'Verifying backup rights...'
+ local l=INFO
+ shift
++ date '+%Y-%m-%d %H:%M:%S'
+ local 'msg=[2025-11-21 14:42:53] [INFO] Verifying backup rights...'
+ echo '[2025-11-21 14:42:53] [INFO] Verifying backup rights...'
[2025-11-21 14:42:53] [INFO] Verifying backup rights...
+ echo '[2025-11-21 14:42:53] [INFO] Verifying backup rights...'
++ db2_cmd 'db2 "VALUES CURRENT USER"'
++ grep -v '^$'
++ head -n 1
++ xargs
++ tr -d '\n\r'
++ tail -n +4
+ local 'auth_id=++ true'
+ [[ -z ++ true ]]
+ [[ ++ true =~ SQLSTATE ]]
+ [[ -z ++ true ]]
+ [[ ++ true =~ SQLSTATE ]]
+ log INFO 'Auth ID: ++ true'
+ local l=INFO
+ shift
++ date '+%Y-%m-%d %H:%M:%S'
+ local 'msg=[2025-11-21 14:42:54] [INFO] Auth ID: ++ true'
+ echo '[2025-11-21 14:42:54] [INFO] Auth ID: ++ true'
[2025-11-21 14:42:54] [INFO] Auth ID: ++ true
+ echo '[2025-11-21 14:42:54] [INFO] Auth ID: ++ true'
+ local has_sys=false has_dbadm=false has_backup=false errs=0
++ db2_cmd 'db2 "SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''++ true'\'', '\''U'\'')) AS T"'
+ local 'sq=++ local '\''cmd=db2 "SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T"'\''
++ source '\''~db2inst1/sqllib/db2profile'\''
++ source '\''/opt/ibm/db2/V*/db2profile'\''
++ true
++ eval '\''db2 "SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T"'\''
+++ db2 '\''SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T'\''
SQL1024N  A database connection does not exist.  SQLSTATE=08003'
+ echo '++ local '\''cmd=db2 "SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T"'\''
++ source '\''~db2inst1/sqllib/db2profile'\''
++ source '\''/opt/ibm/db2/V*/db2profile'\''
++ true
++ eval '\''db2 "SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T"'\''
+++ db2 '\''SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T'\''
SQL1024N  A database connection does not exist.  SQLSTATE=08003'
+ grep -qiE '(SYSADM|SYSCTRL|SYSMAINT)'
+ echo '++ local '\''cmd=db2 "SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T"'\''
++ source '\''~db2inst1/sqllib/db2profile'\''
++ source '\''/opt/ibm/db2/V*/db2profile'\''
++ true
++ eval '\''db2 "SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T"'\''
+++ db2 '\''SELECT AUTHORIZATION FROM TABLE(SYSPROC.AUTH_LIST_AUTHORITIES_FOR_AUTHID('\''\'\'''\''++ true'\''\'\'''\'', '\''\'\'''\''U'\''\'\'''\'')) AS T'\''
SQL1024N  A database connection does not exist.  SQLSTATE=08003'
+ grep -q SQLSTATE
+ log WARN 'Cannot query system authorities'
+ local l=WARN
+ shift
++ date '+%Y-%m-%d %H:%M:%S'
+ local 'msg=[2025-11-21 14:42:55] [WARN] Cannot query system authorities'
+ echo '[2025-11-21 14:42:55] [WARN] Cannot query system authorities'
[2025-11-21 14:42:55] [WARN] Cannot query system authorities
+ echo '[2025-11-21 14:42:55] [WARN] Cannot query system authorities'
+ (( errs++ ))
[root@db2 db2-protect]#
